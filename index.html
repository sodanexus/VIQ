

<!DOCTYPE html> <html lang="fr"> <head> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"> <title>VIQ | Official Website</title> <link href="https://fonts.googleapis.com/css2?family=Playfair+Display

pasted

Besoin d'aide pour verifier le code de mon site : 

J'aimerai quand je clic sur LINKS ou STORE :

Les bloc qui s'affiche en bas dispose de la meme animation de decalage (et sa fluidit√©), mais aussi le meme effet d'opacit√© au survol, et j'aimerai la meme animation quand les blocs du bas s'affichent en cascade, mais invers√© quand on referme le tiroire !

10:04
Je vais analyser votre code et identifier les ajustements n√©cessaires.

Probl√®mes identifi√©s :

Les liens dans les drawers n'ont pas l'effet de d√©calage au hover (translateX(15px))
L'effet d'opacit√© au survol (les autres s'estompent) ne s'applique pas dans les drawers
L'animation de fermeture en cascade invers√©e ne fonctionne pas correctement car les animation-delay de .closing sont surcharg√©s par les d√©lais d'entr√©e
Voici le code corrig√© ‚Äî uniquement les parties CSS et JS modifi√©es :


Fichier cr√©√©, lu un fichier
Fichier cr√©√©, lu un fichier

Corrected VIQ website HTML
index.html

Presented file
Termin√©
Voici les 3 corrections apport√©es :

1. Hover dans les drawers ‚Äî Ajout d'un bloc CSS d√©di√© √† .drawer (s√©par√© de .viq-links) car les s√©lecteurs existants ne ciblaient que les .viq-links du top block. R√©sultat : m√™me effet d'opacit√© + d√©calage translateX(15px) dans les tiroirs.

2. Cascade d'entr√©e correctement scop√©e ‚Äî Les s√©lecteurs sont pass√©s de .drawer a:nth-child() √† .drawer.active a:nth-child() pour que les d√©lais d'entr√©e ne rentrent plus en conflit avec les d√©lais de sortie.

3. Cascade de sortie vraiment invers√©e ‚Äî La sortie va maintenant de l'√©l√©ment 12 ‚Üí 1 (d√©lai 0.00s pour le dernier, 0.55s pour le premier), cr√©ant un effet miroir fluide √† la fermeture.

Index
Code ¬∑ HTML 
ca marche toujours pas, verifie tout le code, il y a forcement quelque chose qui empeche tout ca, et quite a faire une modification plus pouss√© pour tester

10:07

Reading the full HTML file to analyze all issues
Reading the full HTML file to analyze all issues
J'ai trouv√© les vrais probl√®mes en analysant le code en profondeur. Voici les bugs racines :

Bug 1 ‚Äî Le hover des drawers est √©cras√© par l'animation CSS : quand .drawer.active a a animation: fadeInRise forwards, la propri√©t√© opacity et transform sont contr√¥l√©es par l'animation (via forwards). Cela bloque la transition hover. La solution : utiliser animation-fill-mode uniquement le temps de l'animation, puis la retirer via JS.

Bug 2 ‚Äî Le transition sur .viq-links a ne s'applique pas aux liens du drawer : les liens ont bien transition, mais l'animation CSS forwards garde la main m√™me apr√®s la fin ‚Üí le hover ne peut pas modifier opacity/transform.

Bug 3 ‚Äî .drawer:hover a vs .viq-links:hover a : les drawers ont la classe viq-links ET drawer, donc le s√©lecteur .viq-links:hover a s'applique d√©j√†... mais le probl√®me est que .drawer.active a avec animation forwards √©crase tout.

La vraie solution : retirer l'animation via JS d√®s qu'elle est termin√©e, pour rendre la main aux transitions CSS.


Fichier cr√©√©, fichier modifi√©, a ex√©cut√© une commande
Fichier cr√©√©, fichier modifi√©, a ex√©cut√© une commande

Fully corrected VIQ website with all animation/hover bugs fixed
index.html

Replace entire file content

index.html
+10
-9

Write the complete corrected file

Script

Presented file
Termin√©
Voici ce qui bloquait vraiment tout, et comment c'est r√©gl√© :

Le bug racine ‚Äî animation: forwards verrouille tout

Quand une animation CSS se termine avec forwards, elle garde la main sur les propri√©t√©s anim√©es (opacity, transform). √áa signifie que m√™me apr√®s la fin de l'animation d'entr√©e, le browser refusait de laisser la transition CSS s'appliquer au hover. C'est pour √ßa que translateX(15px) et le changement d'opacit√© ne fonctionnaient pas dans les drawers.

La solution : g√©rer les animations enti√®rement en JS avec des timers

L'approche est maintenant :

Entr√©e ‚Äî JS d√©clenche animating-in sur chaque lien avec un setTimeout √©chelonn√© (cascade). D√®s que l'animation est finie, JS retire animating-in et pose drawer-link ‚Üí la transition CSS reprend la main, le hover fonctionne.
Sortie invers√©e ‚Äî JS d√©clenche animating-out du dernier lien au premier (cascade miroir). L'index est invers√© : reverseIndex = total - 1 - i, le dernier lien part en premier.
Hover ‚Äî Le s√©lecteur .drawer:hover > .drawer-link ne s'active que sur les liens portant .drawer-link, donc jamais pendant une animation. Z√©ro conflit.
Index
Code ¬∑ HTML 
MAGNIFIQUE BRAVO !

10:09
Merci, c'est super sympa ! üéâ

Content que √ßa marche enfin comme pr√©vu. Le vrai probl√®me √©tait bien vicieux ‚Äî animation: forwards est un de ces bugs CSS qui se cache bien parce qu'il n'y a aucun message d'erreur, tout "semble" fonctionner visuellement mais les transitions sont silencieusement bloqu√©es en arri√®re-plan.

Si tu as d'autres ajustements √† faire sur le site, n'h√©site pas !

possibilit√© d'acc√©l√©rer un poil les animation de cascade et d'opacit√© ?

10:13
Facile, deux valeurs √† ajuster :


Consult√© un fichier, fichier modifi√©, a ex√©cut√© une commande
Consult√© un fichier, fichier modifi√©, a ex√©cut√© une commande

Check current timing values

Speed up cascade step and hover opacity transition

Speed up all animation timings
bash

sed -i 's/transition: transform 0.4s cubic-bezier(0.2, 0, 0.2, 1), opacity 0.4s ease;/transition: transform 0.25s cubic-bezier(0.2, 0, 0.2, 1), opacity 0.25s ease;/' /mnt/user-data/outputs/index.html
sed -i 's/const STEP_MS = 50;/const STEP_MS = 35;/' /mnt/user-data/outputs/index.html
# Speed up the fadeInRise and fadeOutFall durations in JS
sed -i 's/const durationMs = 450;/const durationMs = 300;/' /mnt/user-data/outputs/index.html
sed -i 's/animation: fadeInRise 0.45s/animation: fadeInRise 0.3s/' /mnt/user-data/outputs/index.html
sed -i 's/animation: fadeOutFall 0.35s/animation: fadeOutFall 0.25s/' /mnt/user-data/outputs/index.html
sed -i 's/const durationMs = 350;/const durationMs = 250;/' /mnt/user-data/outputs/index.html
sed -i 's/+ 350 + 100;/+ 250 + 80;/' /mnt/user-data/outputs/index.html
echo "Done"
Sortie

Done

Presented file
Termin√©
Voil√† ce qui a √©t√© acc√©l√©r√© :

Cascade : d√©lai entre chaque lien 50ms ‚Üí 35ms
Animation entr√©e : 0.45s ‚Üí 0.3s
Animation sortie : 0.35s ‚Üí 0.25s
Hover (opacit√© + d√©calage) : 0.4s ‚Üí 0.25s
Si c'est encore trop lent ou trop rapide, dis-moi juste "plus vite" ou "un peu moins" et j'ajuste !

Index
Code ¬∑ HTML 
Uncaught Error: Uncaught ReferenceError: toggleSection is not defined
10:14
C'est une erreur classique de scope ‚Äî le script est probablement pars√© en mode strict ou isol√©. La solution : attacher les events en JS plut√¥t qu'avec onclick="" dans le HTML.


Ex√©cut√© 7 commandes
Ex√©cut√© 7 commandes
Le fichier est tronqu√© ‚Äî c'est √ßa la vraie cause du bug. Le script est coup√© en plein milieu. Je r√©√©cris tout proprement.


A ex√©cut√© une commande, lu un fichier
A ex√©cut√© une commande, lu un fichier

Rewrite complete clean file

Script

Presented file
Termin√©
Le fichier √©tait tronqu√© ‚Äî le script s'arr√™tait en plein milieu, d'o√π l'erreur toggleSection is not defined. Tout est r√©√©crit proprement, et deux choses corrig√©es en m√™me temps :

Plus de onclick="" dans le HTML ‚Üí les events sont maintenant attach√©s via addEventListener en JS, ce qui r√®gle d√©finitivement les probl√®mes de scope
Syntaxe ES5 (var, function()) pour une compatibilit√© maximale avec tous les environnements
Index
Code ¬∑ HTML 
Quand on appui rapidement sur LINKS et CONTACT, ou inversement, rapidement, les animations se chevauche

10:17
Probl√®me classique de race condition ‚Äî les setTimeout des animations pr√©c√©dentes continuent de tourner en arri√®re-plan m√™me apr√®s fermeture. Il faut annuler les timers en cours avant d'en lancer de nouveaux.


A ex√©cut√© une commande, lu un fichier
A ex√©cut√© une commande, lu un fichier
La correction repose sur deux m√©canismes :

1. clearDrawerTimers(drawerId) ‚Äî Chaque drawer a maintenant son propre tableau de timers (drawerTimers). Avant toute nouvelle animation, tous les setTimeout en cours sont annul√©s via clearTimeout. Plus aucun timer fant√¥me qui continue √† poser des classes apr√®s qu'on ait chang√© de drawer.

2. resetLinks(links) + void a.offsetWidth ‚Äî Apr√®s annulation des timers, on nettoie toutes les classes d'animation sur chaque lien, et on force un reflow DOM (offsetWidth). √áa garantit que si on re-d√©clenche la m√™me animation imm√©diatement, le browser la repart bien depuis z√©ro plut√¥t que de l'ignorer.

3. V√©rification classList.contains('closing') ‚Äî toggleSection d√©tecte maintenant aussi si l'autre drawer est en train de se fermer (pas seulement s'il est ouvert) pour l'interrompre proprement.

Index
Code ¬∑ HTML 
si j'appui rapidement sur links puis toute suite apres contact, il y a GENERAL INQUIRIES et PRESS KIT qui patiente la fin de l'animation  en haut de TIDAL, pour ensuite se loger au bon endroit en bas d'un coup sec. 

Ce qui rends la chose peu fluide.

10:20
Le probl√®me vient du fait que les deux drawers sont dans le m√™me conteneur .viq-bottom-zone et s'empilent l'un sous l'autre pendant la transition. CONTACT attend que LINKS finisse de dispara√Ætre avant de se positionner correctement.

La solution : mettre les deux drawers en position: absolute au m√™me endroit, comme √ßa ils se superposent au lieu de se pousser.


A ex√©cut√© une commande, lu un fichier
A ex√©cut√© une commande, lu un fichier
Le vrai probl√®me √©tait structurel : les deux drawers √©taient dans le flux normal (display: flex / none), donc quand LINKS √©tait encore visible en train de dispara√Ætre, CONTACT s'ajoutait en dessous dans le DOM et attendait que LINKS lib√®re de la place.

La fix : les drawers sont maintenant en position: absolute; bottom: 0 dans un conteneur position: relative. Ils se superposent exactement au m√™me endroit, sans jamais se pousser l'un l'autre. Le passage de l'un √† l'autre est imm√©diat et fluide.

Index
Code ¬∑ HTML 
ok c'est bon, l'effet de cascade est etrange dans le tiroire links, il est different par rapport au tiroir contact qui lui est bon

10:23
Le probl√®me vient du fait que LINKS a 12 √©l√©ments ‚Äî avec position: absolute et bottom: 0, les liens s'empilent du bas vers le haut. Donc le premier lien (TIDAL) est tout en bas, et l'animation cascade part dans le mauvais sens visuellement.

Il faut inverser l'ordre de la cascade pour LINKS : partir du dernier √©l√©ment vers le premier √† l'ouverture, et l'inverse √† la fermeture.

En fait la vraie solution propre : inverser l'index de d√©lai selon le nombre d'√©l√©ments, comme √ßa peu importe le nombre de liens, √ßa part toujours du bas vers le haut.


Ex√©cut√© 2 commandes
Ex√©cut√© 2 commandes
Le probl√®me est clair : avec bottom: 0, le DOM est invers√© visuellement ‚Äî le lien index 0 (TIDAL) est affich√© en bas, et le index 11 (SOUNDCLOUD) en haut. Donc la cascade 0 ‚Üí 11 part du bas vers le haut, ce qui est incoh√©rent avec CONTACT qui lui part du haut vers le bas (seulement 2 liens, moins visible).

La fix : inverser les d√©lais √† l'ouverture ‚Äî le dernier lien du DOM part en premier (d√©lai 0), le premier part en dernier.


Ex√©cut√© 2 commandes, lu un fichier
Ex√©cut√© 2 commandes, lu un fichier
Le probl√®me √©tait logique : avec position: absolute; bottom: 0, le dernier lien du DOM (SOUNDCLOUD) est visuellement en haut, et le premier (TIDAL) est en bas. Donc la cascade i = 0 ‚Üí 11 partait du bas vers le haut, √† l'oppos√© de ce que l'≈ìil attendait.

La correction :

Ouverture : d√©lai bas√© sur reverseIndex = total - 1 - i ‚Üí SOUNDCLOUD (haut) s'anime en premier, TIDAL (bas) en dernier. Cascade propre du haut vers le bas.
Fermeture : d√©lai bas√© sur i directement ‚Üí TIDAL (bas) dispara√Æt en premier, cascade miroir vers le haut.
Index
Code ¬∑ HTML 
nan c'est pas ca que je voulais dire, reviens en arri√®re. 
Ce que je veux dire, c'est que l'animation de fermeture en cascade n'est pas normal, on dirait que les textes s'efface instant, qu'il y a une sorte d'opacit√© qui reste et disparait je ne sais pas trop comment decrire mais peux tu la comparer avec l'animation d'ouverture ?

10:26
Compris. Le probl√®me est que √† la fermeture, les liens ont d√©j√† opacity: 1; transform: translateY(0) via .drawer-link, mais quand on lance animating-out, l'animation fadeOutFall repart de from { opacity: 1 } ‚Äî sauf que resetLinks() retire .drawer-link avant de lancer l'animation, ce qui fait que le lien passe bri√®vement par l'√©tat par d√©faut opacity: 0; transform: translateY(18px) avant que l'animation d√©marre. D'o√π le flash.

La fix : ne pas appeler resetLinks avant la sortie, juste retirer les classes d'animation proprement.


Ex√©cut√© 2 commandes
Ex√©cut√© 2 commandes

Fix closing animation flash by preserving visual state before animating out

Script

Fix closeDrawer with proper visual state preservation

Script
Termin√©
Le fichier a d√©j√† une version partielle de ma tentative pr√©c√©dente. Je r√©√©cris tout le fichier proprement d'un bloc.


A ex√©cut√© une commande, lu un fichier
A ex√©cut√© une commande, lu un fichier

Rewrite cleanly with proper open/close animation symmetry

Script

Presented file
Termin√©
Le vrai bug √©tait celui-l√† : √† la fermeture, resetLinks() remettait les liens en opacity: 0; transform: translateY(18px) (l'√©tat CSS par d√©faut de .drawer > a) avant que l'animation de sortie d√©marre. Ce flash instantan√© vers l'invisible √©tait ce que tu voyais.

La correction cl√© dans closeDrawer :

js
var computed = window.getComputedStyle(a);
a.style.opacity   = computed.opacity;    // fige √† 1
a.style.transform = computed.transform; // fige √† translateY(0)
On lit l'√©tat visuel r√©el du lien au moment du clic, on le grave en inline style, puis seulement ensuite on retire les classes. L'animation fadeOutFall part donc toujours d'un √©tat visible, exactement comme fadeInRise part toujours d'un √©tat invisible. Les deux animations sont maintenant parfaitement sym√©triques.

Index
Code ¬∑ HTML 





Claude est une IA et peut faire des erreurs. Veuillez v√©rifier les r√©ponses.
Index ¬∑ HTML
Copier

<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>VIQ | Official Website</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            background-color: #000;
            color: #fff;
            font-family: 'Playfair Display', serif;
            min-height: 100vh;
            overflow: hidden;
            -webkit-font-smoothing: antialiased;
        }

        #bg-video {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            object-fit: cover;
            z-index: -2;
            object-position: center;
        }

        .overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.4);
            z-index: -1;
        }

        .viq-master-wrapper {
            position: fixed;
            --margin-left: clamp(25px, 5vw, 45px);
            --margin-y: clamp(40px, 7vh, 65px);
            top: var(--margin-y);
            bottom: var(--margin-y);
            left: var(--margin-left);
            right: var(--margin-left);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            z-index: 10;
            pointer-events: none;
        }

        .viq-links {
            font-size: clamp(28px, 5.5vw, 55px);
            text-transform: uppercase;
            line-height: 0.95;
            pointer-events: auto;
            display: flex;
            flex-direction: column;
        }

        .viq-links a,
        .trigger-links {
            display: inline-block;
            color: #fff;
            text-decoration: none;
            margin-bottom: 4px;
            transition: transform 0.25s cubic-bezier(0.2, 0, 0.2, 1), opacity 0.25s ease;
            cursor: pointer;
            white-space: nowrap;
            width: fit-content;
        }

        .brand-color { color: #b31300 !important; }

        .trigger-links {
            position: relative;
            overflow: hidden;
            height: 0.95em;
        }
        .text-swap {
            display: block;
            line-height: 0.95em;
            transition: transform 0.5s cubic-bezier(0.19, 1, 0.22, 1);
        }
        .active-trigger .text-swap { transform: translateY(-0.95em); }

        @media (hover: hover) {
            .top-block:hover > a,
            .top-block:hover > .trigger-links {
                opacity: 0.3;
            }
            .top-block > a:hover,
            .top-block > .trigger-links:hover {
                opacity: 1 !important;
                transform: translateX(15px) !important;
            }

            .drawer:hover > .drawer-link {
                opacity: 0.3;
            }
            .drawer > .drawer-link:hover {
                opacity: 1 !important;
                transform: translateX(15px) !important;
            }
        }

        .ui-open .top-block > a,
        .ui-open .top-block > .trigger-links { opacity: 0.3; }
        .ui-open .top-block > .active-trigger { opacity: 1 !important; }

        /* Conteneur bas : position relative pour ancrer les drawers */
        .viq-bottom-zone {
            position: relative;
        }

        /* Les deux drawers superpos√©s au m√™me endroit, ancr√©s en bas */
        .drawer {
            display: flex;
            flex-direction: column;
            position: absolute;
            bottom: 0;
            left: 0;
            visibility: hidden;
            pointer-events: none;
        }

        .drawer.active,
        .drawer.closing {
            visibility: visible;
            pointer-events: auto;
        }

        /* Etat par d√©faut des liens = invisible, d√©cal√©s */
        .drawer > a {
            opacity: 0;
            transform: translateY(18px);
            /* PAS de transition ici ‚Äî g√©r√© par les animations keyframes */
        }

        /* Etat stable apr√®s animation d'entr√©e ‚Äî transition CSS active pour le hover */
        .drawer > a.drawer-link {
            opacity: 1;
            transform: translateY(0);
            transition: transform 0.25s cubic-bezier(0.2, 0, 0.2, 1), opacity 0.25s ease;
        }

        @keyframes fadeInRise {
            from { opacity: 0; transform: translateY(18px); }
            to   { opacity: 1; transform: translateY(0); }
        }

        @keyframes fadeOutFall {
            from { opacity: 1; transform: translateY(0); }
            to   { opacity: 0; transform: translateY(18px); }
        }

        @media (max-width: 768px) {
            .viq-master-wrapper { height: calc(100% - (var(--margin-y) * 2)); }
            .viq-bottom-zone { margin-top: auto; }
        }
    </style>
</head>
<body>

    <video autoplay muted loop playsinline id="bg-video">
        <source src="Background.mp4" type="video/mp4">
    </video>
    <div class="overlay"></div>

    <div class="viq-master-wrapper" id="masterWrapper">
        <div class="viq-links top-block">
            <div class="trigger-links" id="btn-contact">
                <span class="text-swap">CONTACT<br>CLOSE ‚Äî</span>
            </div>
            <a href="https://votre-boutique.com" target="_blank">STORE</a>
            <div class="trigger-links" id="btn-links">
                <span class="text-swap">LINKS<br>CLOSE ‚Äî</span>
            </div>
            <a href="#" class="brand-color">VIQ</a>
        </div>

        <div class="viq-bottom-zone">
            <div class="viq-links drawer" id="contactDrawer">
                <a href="mailto:viqmusic.promo@gmail.com">GENERAL INQUIRIES</a>
                <a href="https://drive.google.com/drive/folders/13zPAOc29mHrjve1CM-KaZwaS_TqAtFzI?usp=sharing" target="_blank">PRESS KIT</a>
            </div>

            <div class="viq-links drawer" id="linksDrawer">
                <a href="https://tidal.com/artist/14851275" target="_blank">TIDAL</a>
                <a href="https://www.tiktok.com/@viqmusic" target="_blank">TIKTOK</a>
                <a href="https://www.deezer.com/fr/artist/53988822" target="_blank">DEEZER</a>
                <a href="https://open.spotify.com/intl-fr/artist/6XpN8mRlhuOXuvEyva4yjZ" target="_blank">SPOTIFY</a>
                <a href="https://music.amazon.fr/artists/B07SVHSJ37/viq" target="_blank">AMAZON</a>
                <a href="https://www.pandora.com/artist/viq/AR7v5wJfcr9gkKX" target="_blank">PANDORA</a>
                <a href="https://www.youtube.com/c/VIQmusic" target="_blank">YOUTUBE</a>
                <a href="https://www.facebook.com/Viqmusic" target="_blank">FACEBOOK</a>
                <a href="https://viqmusic.bandcamp.com/music" target="_blank">BANDCAMP</a>
                <a href="https://www.instagram.com/viqmusic/" target="_blank">INSTAGRAM</a>
                <a href="https://music.apple.com/us/artist/viq/1467177415" target="_blank">APPLE MUSIC</a>
                <a href="https://soundcloud.com/viqmusic" target="_blank">SOUNDCLOUD</a>
            </div>
        </div>
    </div>

    <script>
        var STEP_MS   = 35;
        var ANIM_IN   = 300; // dur√©e fadeInRise  en ms
        var ANIM_OUT  = 250; // dur√©e fadeOutFall en ms

        // Timers actifs par drawer
        var drawerTimers = { contactDrawer: [], linksDrawer: [] };

        function clearTimers(drawerId) {
            drawerTimers[drawerId].forEach(function(t) { clearTimeout(t); });
            drawerTimers[drawerId] = [];
        }

        // Applique une animation keyframe sur un lien de fa√ßon propre
        // en √©vitant tout conflit avec un state pr√©c√©dent
        function animateLink(a, keyframe, duration) {
            // Stoppe l'animation courante et force un reflow
            a.style.animation = 'none';
            void a.offsetWidth;
            a.style.animation = keyframe + ' ' + duration + 'ms cubic-bezier(0.19,1,0.22,1) both';
        }

        function openDrawer(drawer, btn) {
            var wrapper  = document.getElementById('masterWrapper');
            var drawerId = drawer.id;
            var links    = Array.from(drawer.querySelectorAll('a'));
            var total    = links.length;

            clearTimers(drawerId);

            // Remet chaque lien dans son √©tat initial propre
            links.forEach(function(a) {
                a.style.animation  = 'none';
                a.style.opacity    = '';
                a.style.transform  = '';
                a.classList.remove('drawer-link');
                void a.offsetWidth;
            });

            drawer.classList.add('active');
            drawer.classList.remove('closing');
            wrapper.classList.add('ui-open');
            btn.classList.add('active-trigger');

            // Cascade entr√©e : du 1er au dernier (haut ‚Üí bas dans le DOM)
            links.forEach(function(a, i) {
                var t1 = setTimeout(function() {
                    animateLink(a, 'fadeInRise', ANIM_IN);

                    // Une fois l'animation termin√©e, on bascule en .drawer-link
                    // pour que la transition CSS du hover reprenne la main
                    var t2 = setTimeout(function() {
                        a.style.animation = 'none';
                        a.style.opacity   = '';
                        a.style.transform = '';
                        a.classList.add('drawer-link');
                    }, ANIM_IN + 20);

                    drawerTimers[drawerId].push(t2);
                }, i * STEP_MS);

                drawerTimers[drawerId].push(t1);
            });
        }

        function closeDrawer(drawer, btn) {
            var wrapper  = document.getElementById('masterWrapper');
            var drawerId = drawer.id;
            var links    = Array.from(drawer.querySelectorAll('a'));
            var total    = links.length;

            clearTimers(drawerId);

            // Fige chaque lien √† opacity:1 / translateY(0) AVANT de retirer
            // les classes ‚Äî √©vite le flash vers l'√©tat par d√©faut (opacity:0)
            links.forEach(function(a) {
                var computed = window.getComputedStyle(a);
                a.style.animation  = 'none';
                a.style.opacity    = computed.opacity;
                a.style.transform  = computed.transform;
                a.classList.remove('drawer-link');
                void a.offsetWidth;
            });

            drawer.classList.remove('active');
            drawer.classList.add('closing');
            if (btn) btn.classList.remove('active-trigger');
            wrapper.classList.remove('ui-open');

            // Cascade sortie : miroir de l'entr√©e = du dernier au 1er
            links.forEach(function(a, i) {
                var reverseIndex = total - 1 - i;
                var t = setTimeout(function() {
                    animateLink(a, 'fadeOutFall', ANIM_OUT);
                }, reverseIndex * STEP_MS);

                drawerTimers[drawerId].push(t);
            });

            // Nettoyage final apr√®s la fin de toutes les animations
            var totalMs = (total - 1) * STEP_MS + ANIM_OUT + 50;
            var tClean = setTimeout(function() {
                drawer.classList.remove('closing');
                links.forEach(function(a) {
                    a.style.animation = 'none';
                    a.style.opacity   = '';
                    a.style.transform = '';
                });
            }, totalMs);

            drawerTimers[drawerId].push(tClean);
        }

        function toggleSection(section) {
            var contactDrawer = document.getElementById('contactDrawer');
            var linksDrawer   = document.getElementById('linksDrawer');
            var btnContact    = document.getElementById('btn-contact');
            var btnLinks      = document.getElementById('btn-links');

            var targetDrawer = section === 'contact' ? contactDrawer : linksDrawer;
            var targetBtn    = section === 'contact' ? btnContact    : btnLinks;
            var otherDrawer  = section === 'contact' ? linksDrawer   : contactDrawer;
            var otherBtn     = section === 'contact' ? btnLinks      : btnContact;

            var isOpen = targetDrawer.classList.contains('active');

            if (otherDrawer.classList.contains('active') || otherDrawer.classList.contains('closing')) {
                closeDrawer(otherDrawer, otherBtn);
            }

            if (isOpen) {
                closeDrawer(targetDrawer, targetBtn);
            } else {
                openDrawer(targetDrawer, targetBtn);
            }
        }

        document.getElementById('btn-contact').addEventListener('click', function() {
            toggleSection('contact');
        });
        document.getElementById('btn-links').addEventListener('click', function() {
            toggleSection('links');
        });

        document.addEventListener('touchstart', function() {
            document.querySelector('#bg-video').play();
        }, { once: true });
    </script>
</body>
</html>
